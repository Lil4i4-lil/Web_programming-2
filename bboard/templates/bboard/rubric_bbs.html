{% load i18n %}
<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
    <head>
        <meta charset="UTF-8">
        <title>{{ current_rubric.name }} :: {% trans "Bulletin Board" %}</title>
        <style>
            .language-switcher {
                margin: 10px 0;
                padding: 10px;
                background-color: #f5f5f5;
                border-radius: 5px;
            }
            .language-switcher select {
                padding: 5px;
                border: 1px solid #ddd;
                border-radius: 3px;
            }
            nav a {
                margin-right: 15px;
                text-decoration: none;
                color: #007bff;
            }
            nav a:hover {
                text-decoration: underline;
            }
            .advertisement {
                border: 1px solid #ddd;
                padding: 15px;
                margin: 10px 0;
                border-radius: 5px;
            }
        </style>
    </head>
    <body>
        <h1>{% trans "Advertisements" %}</h1>
        <h2>{% trans "Rubric" %}: {{ current_rubric.name }}</h2>

        <!-- Переключатель языков -->
        <div class="language-switcher">
            <form action="{% url 'set_language' %}" method="post">
                {% csrf_token %}
                <input name="next" type="hidden" value="{{ request.path }}">
                <select name="language" onchange="this.form.submit()">
                    {% get_current_language as CURRENT_LANGUAGE %}
                    {% get_available_languages as LANGUAGES %}
                    {% get_language_info_list for LANGUAGES as languages %}
                    {% for language in languages %}
                        <option value="{{ language.code }}"
                                {% if language.code == CURRENT_LANGUAGE %}selected{% endif %}>
                            {{ language.name_local }}
                        </option>
                    {% endfor %}
                </select>
            </form>
        </div>

        <!-- Навигация -->
        <nav>
            <a href="{% url 'index' %}">{% trans "Main" %}</a>
            {% for rubric in rubrics %}
            <a href="{% url 'rubric_bbs' rubric.pk %}">{{ rubric.name }}</a>
            {% endfor %}
            <a href="{% url 'add' %}">{% trans "Add advertisement" %}</a>
        </nav>

        <!-- Список объявлений -->
        {% for bb in bbs %}
        <div class="advertisement">
            <h3>{{ bb.title }}</h3>
            <p>{{ bb.content }}</p>
            <p><strong>{% trans "Published" %}:</strong> {{ bb.published|date:"d.m.Y H:i:s" }}</p>
            {% if bb.price %}
            <p><strong>{% trans "Price" %}:</strong> {{ bb.price }}</p>
            {% endif %}
        </div>
        {% empty %}
        <div class="advertisement">
            <p>{% trans "No advertisements in this rubric" %}</p>
        </div>
        {% endfor %}

        <!-- Информация о количестве -->
        <div style="margin-top: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
            <p>
                {% blocktrans count counter=bbs.count %}
                There is {{ counter }} advertisement in this rubric.
                {% plural %}
                There are {{ counter }} advertisements in this rubric.
                {% endblocktrans %}
            </p>
        </div>

        <!-- Ссылка для возврата -->
        <div style="margin-top: 20px;">
            <a href="{% url 'index' %}">← {% trans "Back to main page" %}</a>
        </div>
    </body>
</html>